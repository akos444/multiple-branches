<!DOCTYPE html>
<html lang="hu">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CSV Adatok</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
</head>

<body>
    <div class="container mt-5">
        <h1 class="text-center">CSV Adatok</h1>
        
        <div class="mb-3" style="display: flex; justify-content: space-evenly;">
            <button class="btn btn-outline-dark" id="afrika-btn">Afrika</button>
            <button class="btn btn-outline-dark" id="azsia-btn">Ázsia</button>
            <button class="btn btn-outline-dark" id="europa-btn">Európa</button>
        </div>
        <input type="text" id="kereses" class="form-control mb-3" placeholder="Keresés országra...">
        <div id="tablazat-container"></div>

        <div id="kartyak" class="row"></div>
    </div>


    <script>
        document.addEventListener('DOMContentLoaded', function () {
            document.getElementById('afrika-btn').addEventListener('click', function () {
                fetch_adatok('afrika');
            });

            document.getElementById('azsia-btn').addEventListener('click', function () {
                fetch_adatok('azsia');
            });

            document.getElementById('europa-btn').addEventListener('click', function () {
                fetch_adatok('europa');
            });

            function fetch_adatok(kontinens) {
                fetch(`http://localhost:4000/${kontinens}`)
                    .then(response => response.json())
                    .then(adatok => {
                        generaltabla(adatok, kontinens);
                        generalkartyak(adatok, kontinens);
                    })
                    .catch(error => {
                        console.error('Hiba történt az adatok betöltése közben:', error);
                    });
            }

            function generaltabla(adatok, kontinens) {
                const tablazat_container = document.getElementById('tablazat-container');
                tablazat_container.innerHTML = '';

                const tabla = document.createElement('table');
                tabla.classList.add('table', 'table-striped');

                const thead = document.createElement('thead');
                const sor_fejlec = document.createElement('tr');

                const fejlec_orszag = document.createElement('th');
                fejlec_orszag.textContent = 'Ország';
                sor_fejlec.appendChild(fejlec_orszag);

                const fejlec_adat1 = document.createElement('th');
                fejlec_adat1.textContent = 'Főváros';
                sor_fejlec.appendChild(fejlec_adat1);

                const fejlec_adat2 = document.createElement('th');
                fejlec_adat2.textContent = 'Terület';
                sor_fejlec.appendChild(fejlec_adat2);

                const fejlec_adat3 = document.createElement('th');
                fejlec_adat3.textContent = 'Népesség';
                sor_fejlec.appendChild(fejlec_adat3);

                const fejlec_adat4 = document.createElement('th');
                fejlec_adat4.textContent = 'Népsűrűség';
                sor_fejlec.appendChild(fejlec_adat4);

                const fejlec_adat5 = document.createElement('th');
                fejlec_adat5.textContent = 'Térkép';
                sor_fejlec.appendChild(fejlec_adat5);

                thead.appendChild(sor_fejlec);
                tabla.appendChild(thead);

                const tbody = document.createElement('tbody');

                for (let key in adatok) {
                    
                    if (adatok.hasOwnProperty(key)) {
                        const sor = adatok[key];
                        const tr = document.createElement('tr');

                        const td_orszag = document.createElement('td');
                        td_orszag.textContent = sor.orszag;
                        tr.appendChild(td_orszag);

                        const td_adat1 = document.createElement('td');
                        td_adat1.textContent = sor.fovaros;
                        tr.appendChild(td_adat1);

                        const td_adat2 = document.createElement('td');
                        td_adat2.textContent = sor.terulet;
                        tr.appendChild(td_adat2);

                        const td_adat3 = document.createElement('td');
                        td_adat3.textContent = sor.nepesseg;
                        tr.appendChild(td_adat3);

                        const td_adat4 = document.createElement('td');
                        td_adat4.textContent = sor.nepsuruseg;
                        tr.appendChild(td_adat4);

                        const td_adat5 = document.createElement('td');
                        if (sor.kep !== 'nopic') {
                            const img = document.createElement('img');
                            img.src = `img/${sor.kep}`;
                            img.alt = sor.orszag;
                            img.classList.add('img-fluid');
                            img.style.maxWidth = '200px';
                            td_adat5.appendChild(img);
                        } else {
                            td_adat5.textContent = 'Nincs kép';
                        }
                        tr.appendChild(td_adat5);

                        tbody.appendChild(tr);
                    }
                }

                tabla.appendChild(tbody);
                tablazat_container.appendChild(tabla);
            }

            function generalkartyak(adatok, kontinens) {
                const kartyak_container = document.getElementById('kartyak');
                kartyak_container.innerHTML = ''; 

                for (let key in adatok) {
                    if (adatok.hasOwnProperty(key)) {
                        const sor = adatok[key];

                        const kartya = document.createElement('div');
                        kartya.classList.add('col-lg-3', 'mb-4');

                        const kartya_element = document.createElement('div');
                        kartya_element.classList.add('card', 'h-100');

                        const kartya_header = document.createElement('div');
                        kartya_header.classList.add('card-header');
                        kartya_header.textContent = sor.orszag;
                        kartya_element.appendChild(kartya_header);

                        const kartya_body = document.createElement('div');
                        kartya_body.classList.add('card-body');

                        const fovaros = document.createElement('p');
                        fovaros.textContent = `Főváros: ${sor.fovaros}`;
                        kartya_body.appendChild(fovaros);

                        const terulet = document.createElement('p');
                        terulet.textContent = `Terület: ${sor.terulet}`;
                        kartya_body.appendChild(terulet);

                        const nepesseg = document.createElement('p');
                        nepesseg.textContent = `Népesség: ${sor.nepesseg}`;
                        kartya_body.appendChild(nepesseg);

                        const nepsuruseg = document.createElement('p');
                        nepsuruseg.textContent = `Népsűrűség: ${sor.nepsuruseg}`;
                        kartya_body.appendChild(nepsuruseg);

                        kartya_element.appendChild(kartya_body);
                        kartya.appendChild(kartya_element);
                        kartyak_container.appendChild(kartya);
                    }
                }
            }

        });
    </script>
</body>

</html>